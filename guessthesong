<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guess the Song тАФ BDAY WEEK</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Noto+Sans+Tamil:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* General Setup & Theming */
        :root {
            --blush: #ffdde1;
            --navy: #0f172a;
            --pink: #f72585;
            --purple: #7209b7;
            --white: #ffffff;
            --light-gray: #f8f9fa;
            --gray: #6c757d;
            --green: #2ecc71;
            --orange: #f39c12;
            --font-sans: 'Poppins', sans-serif;
            --font-tamil: 'Noto Sans Tamil', sans-serif;
        }

        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }

        body {
            font-family: var(--font-sans);
            color: var(--white);
            background: linear-gradient(160deg, var(--navy) 0%, #3f375b 50%, #f77062 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
        }

        /* Starry Background Effect */
        #star-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .star {
            position: absolute;
            background-color: var(--white);
            border-radius: 50%;
            animation: twinkle 5s infinite;
            opacity: 0;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0; transform: scale(0.5); }
            50% { opacity: 0.8; transform: scale(1); }
        }

        /* Main Container & Screens */
        .container {
            width: 100%;
            max-width: 960px;
            padding: 2rem;
            text-align: center;
        }

        .screen {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            animation: fadeIn 0.7s ease-in-out;
        }

        .screen.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Typography */
        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--blush);
            text-shadow: 0 0 15px rgba(255, 221, 225, 0.5);
        }

        h2 {
            font-size: 2rem;
            margin-bottom: 1rem;
        }
        
        p {
            font-size: 1.1rem;
            font-weight: 300;
            max-width: 400px;
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        /* Buttons */
        .btn {
            padding: 1rem 2rem;
            border-radius: 50px;
            border: none;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            background-color: var(--pink);
            color: var(--white);
            box-shadow: 0 4px 15px rgba(247, 37, 133, 0.4);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(247, 37, 133, 0.6);
        }

        .btn-secondary {
            background-color: transparent;
            color: var(--blush);
            border: 1px solid var(--blush);
            box-shadow: none;
            margin: 0.5rem;
        }
        
        .btn-secondary:hover {
            background-color: var(--blush);
            color: var(--navy);
            box-shadow: none;
        }
        
        .btn-home {
            background: none;
            border: none;
            color: var(--blush);
            font-family: var(--font-sans);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }

        .btn-home:hover {
            opacity: 1;
        }

        /* Game Screen */
        .scoreboard {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 2rem;
            color: var(--blush);
        }
        
        #high-score {
            text-align: left;
        }

        #round-counter {
            text-align: right;
        }

        .lyric-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 3rem 2.5rem;
            width: 100%;
            margin-bottom: 2rem;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.2);
        }

        .lyric-label {
            font-size: 0.9rem;
            font-weight: 300;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--blush);
            margin-bottom: 1rem;
        }

        .lyric-text {
            font-family: var(--font-tamil), var(--font-sans);
            font-size: 1.6rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            line-height: 1.6;
            min-height: 240px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .hint-area {
            font-size: 1rem;
            min-height: 24px;
            color: var(--green);
            font-weight: 600;
        }
        
        .hint-area.revealed {
            color: var(--orange);
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
            width: 100%;
            gap: 1rem;
        }
        
        .answer-input {
            width: 100%;
            padding: 1rem;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: var(--white);
            font-size: 1rem;
            font-family: var(--font-sans);
        }
        
        .answer-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .answer-input:focus {
            outline: none;
            border-color: var(--pink);
            box-shadow: 0 0 10px rgba(247, 37, 133, 0.5);
        }
        
        .input-group.shake .answer-input {
            animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        .action-buttons {
            margin-top: 1rem;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .action-buttons .btn, .action-buttons .btn-secondary {
            display: none;
        }

        /* End Screen */
        .final-score-text {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .final-score {
            font-size: 4rem;
            font-weight: 700;
            color: var(--blush);
            margin-bottom: 1.5rem;
        }

        .end-message {
            font-size: 1.2rem;
            margin-bottom: 2rem;
        }
        
        .signature {
            margin-top: 3rem;
            font-family: 'Brush Script MT', 'Brush Script Std', 'cursive';
            font-size: 1.5rem;
            color: var(--blush);
            opacity: 0.8;
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 1rem 2rem;
            border-radius: 10px;
            color: white;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s, transform 0.3s;
            z-index: 1000;
            font-weight: 600;
        }
        
        .toast.show {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -20px);
        }
        
        .toast-success { background-color: var(--green); }
        .toast-warning { background-color: var(--orange); }
        .toast-info { background-color: var(--purple); }

        /* Confetti Animation */
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 999;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: var(--pink);
            opacity: 0;
            animation: fall 3s linear forwards;
        }

        @keyframes fall {
            0% { transform: translateY(-10vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(110vh) rotate(720deg); opacity: 0; }
        }

    </style>
</head>
<body>
    <div id="star-container"></div>
    <div id="confetti-container" class="confetti-container"></div>
    
    <div class="container">
        <!-- Welcome Screen -->
        <div id="welcome-screen" class="screen active">
            <h1>Guess the Song ЁЯО╡</h1>
            <h2>Ani, welcome to Day 2 of your Birthday Week! ЁЯОЙ</h2>
            <p>This is our special lyric game тАФ a mix of your favorite songs, our memories, and a little challenge for you.<br><br>Get ready to guess, sing along, and maybe even laugh at my tricky picks. ЁЯШП</p>
            <button id="start-btn" class="btn btn-cta">
                Start the Game
            </button>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="screen">
            <div class="scoreboard">
                <button id="game-home-btn" class="btn-home">ЁЯПа Home</button>
                <div id="points-counter">Points: 0</div>
                <div id="high-score-display"></div>
                <div id="round-counter">Round 1 / 25</div>
            </div>

            <div class="lyric-card">
                <div class="lyric-label">Lyric</div>
                <div id="lyric-text" class="lyric-text"></div>
                <div id="hint-area" class="hint-area"></div>
            </div>

            <div id="input-group" class="input-group">
                <input type="text" id="answer-input" class="answer-input" placeholder="Type the song name...">
                <button id="submit-btn" class="btn">Submit</button>
            </div>
            
            <div class="action-buttons">
                <button id="reveal-btn" class="btn-secondary">Reveal Answer</button>
                <button id="next-btn" class="btn">Next Round</button>
            </div>
        </div>

        <!-- End Screen -->
        <div id="end-screen" class="screen">
            <div id="end-title"></div>
            <div class="final-score-text">You scored</div>
            <div id="final-score" class="final-score"></div>
            <p id="end-message" class="end-message"></p>
            <div class="action-buttons" style="display:flex;">
                <button id="play-again-btn" class="btn">Play Again</button>
                <button id="home-btn" class="btn-secondary">Go to Home</button>
                <button id="share-btn" class="btn-secondary">Share Score</button>
            </div>
        </div>
        
    </div>
    
    <div id="toast" class="toast" aria-live="assertive"></div>
    
    <script>
        // --- DOM ELEMENTS ---
        const welcomeScreen = document.getElementById('welcome-screen');
        const gameScreen = document.getElementById('game-screen');
        const endScreen = document.getElementById('end-screen');
        const startBtn = document.getElementById('start-btn');
        const submitBtn = document.getElementById('submit-btn');
        const nextBtn = document.getElementById('next-btn');
        const revealBtn = document.getElementById('reveal-btn');
        const playAgainBtn = document.getElementById('play-again-btn');
        const homeBtn = document.getElementById('home-btn');
        const gameHomeBtn = document.getElementById('game-home-btn');
        const shareBtn = document.getElementById('share-btn');
        
        const pointsCounter = document.getElementById('points-counter');
        const highScoreDisplay = document.getElementById('high-score-display');
        const roundCounter = document.getElementById('round-counter');
        const lyricText = document.getElementById('lyric-text');
        const hintArea = document.getElementById('hint-area');
        const answerInput = document.getElementById('answer-input');
        const inputGroup = document.getElementById('input-group');

        const finalScoreDisplay = document.getElementById('final-score');
        const endMessage = document.getElementById('end-message');
        const endTitle = document.getElementById('end-title');

        // --- GAME DATA ---
        const roundsData = [
            { lyric: "роирпА рокрпЗроЪрпБроорпН ро╡ро╛ро░рпНродрпНродрпИроХро│рпН роЪрпЗроХро░ро┐родрпНродрпБ<br>роЪрпЖропрпНро╡рпЗройрпН роЕройрпНрокрпЗ роУро░рпН роЕроХро░ро╛родро┐<br>роирпА родрпВроЩрпНроХрпБроорпН роирпЗро░родрпНродро┐ро▓рпН родрпВроЩрпНроХро╛рооро▓рпН<br>рокро╛ро░рпНрокрпНрокрпЗройрпН родро┐ройроорпН роЙройрпН родро▓рпИроХрпЛродро┐", answer: "Akkam pakkam" },
            { lyric: "роЕродро┐роХро╛ро▓рпИ ро╡ро┐роЯро┐ро╡родрпЖро▓рпНро▓ро╛роорпН<br>роЙройрпНройрпИ рокро╛ро░рпНроХрпНроХрпБроорпН рооропроХрпНроХродрпНродро┐ро▓рпН родро╛ройрпН<br>роЕроирпНродро┐рооро╛ро▓рпИ рооро▒рпИро╡родрпЖро▓рпНро▓ро╛роорпН<br>роЙройрпНройрпИ рокро╛ро░рпНродрпНрод роХро┐ро░роХрпНроХродрпНродро┐ро▓рпНродро╛ройрпН", answer: "Kadhal vaithu" },
            { lyric: "роОродрпБро╡рпБроорпН рокрпБро░ро┐ропро╛ рокрпБродрпБ роХро╡ро┐родрпИ<br>роЕро░рпНродрпНродроорпН роорпКродрпНродроорпН роЗройрпНро▒рпБ роЕро▒ро┐роирпНродрпЗройрпН<br>роХрпИропрпИ роорпАро▒рпБроорпН роТро░рпБ роХрпБроЯрпИропро╛ропрпН<br>роХро╛ро▒рпНро▒рпЛроЯрпБродро╛ройрпН роиро╛ройрпБроорпН рокро▒роирпНродрпЗройрпН<br>рооро┤рпИроХрпН роХро╛ро▒рпНро▒рпЛроЯрпБродро╛ройрпН роиро╛ройрпБроорпН рокро▒роирпНродрпЗройрпН", answer: "Mudhal mazhai" },
            { lyric: "роЗродрпБро╡ро░рпИ роОройрпНроирпЖроЮрпНроЪро┐ро▓рпН<br>роЗро▓рпНро▓ро╡рпЗ роЗро▓рпНро▓рпИ рокропроЩрпНроХро│рпН<br>роЗро░рогрпНроЯрпБ роиро╛ро│рпН рокро╛ро░рпНродрпНродрпЗройрпЗ<br>рооро┐ро░роЯрпНроЯрпБродрпЗ роЙроирпНродройрпН роХрпБрогроЩрпНроХро│рпН", answer: "En idhayam" },
            { lyric: "роЗродропроорпН роорпБро┤рпБродрпБроорпН роЗро░рпБроХрпНроХрпБроорпН роЗроирпНрод родропроХрпНроХроорпН<br>роОроЩрпНроХрпБ роХрпКрогрпНроЯрпБ роиро┐ро▒рпБродрпНродрпБроорпН<br>роЗродрпИ роЕро▒ро┐роп роОроЩрпНроХрпБ роХро┐роЯрпИроХрпНроХрпБроорпН ро╡ро┐ро│роХрпНроХроорпН<br>роЕродрпБ роХро┐роЯрпИродрпНродро╛ро▓рпН роЪрпКро▓рпНро▓ ро╡рпЗрогрпНроЯрпБроорпН роОройроХрпНроХрпБроорпН", answer: "Pookal Pookum" },
            { lyric: "роирпА роЪрпЖройрпНро▒ро╛ро▓рпН роХрпВроЯ ро╡ро╛роЪроорпН ро╡рпАроЪрпБроорпН ро╡рпАроЪрпБроорпН ро╡рпАроЪрпБроорпН ро╡рпАроЪрпБроорпН<br>роОройрпН роЕройрпНрокрпЗ роОройрпН роиро╛роЯрпНроХро│рпН роОройрпНро▒рпБроорпН рокрпЛро▓ рокрпЛроХрпБроорпН рокрпЛроХрпБроорпН рокрпЛроХрпБроорпН рокрпЛроХрпБроорпН<br>роОройрпН роЙро│рпНро│рпЗ роОройрпН роЙро│рпНро│рпЗ<br>родройрпНройро╛ро▓рпЗ роХро╛родро▓рпН роХрогроорпН роХрпКрогрпНроЯрпЗройрпН", answer: "Dhimu dhimu" },
            { lyric: "роЗро░рогрпНроЯрпБроорпН роХрпИ роХрпЛро░рпНродрпНродрпБ роЪрпЗро░рпНроирпНродродрпБ<br>роЗроЯрпИропро┐ро▓рпН рокрпКропрпНрокрпВроЯрпНроЯрпБ рокрпЛройродрпБ<br>ро╡ро╛роЪро▓рпН родро▓рпНро▓ро╛роЯрпБродрпЗ<br>родро┐рогрпНроЯро╛роЯрпБродрпЗ роХрпКрогрпНроЯро╛роЯрпБродрпЗ", answer: "Oru padhi kadhavu" },
            { lyric: "роЙройрпН родрпЛро│ро┐ро▓рпН роЪро╛ропрпБроорпН рокрпЛродрпБ<br>роЙро▒рпНроЪро╛роХроорпН роХрпКро│рпНро│рпБроорпН роХрогрпНроХро│рпН<br>роирпА роОроЩрпНроХрпЗ роОроЩрпНроХрпЗ роОройрпНро▒рпБ<br>роЙройрпНройрпИ родрпЗроЯро┐ родрпЗроЯро┐ рокро╛ро░рпНроХрпНроХро┐ро▒родрпБ<br>роЙройрпНройрпЛроЯрпБ рокрпЛроХрпБроорпН рокрпЛродрпБ<br>рокрпВ рокрпВроХрпНроХрпБроорпН роЪро╛ро▓рпИропро╛ро╡рпБроорпН<br>роирпА роОроЩрпНроХрпЗ роОройрпНро▒рпБ роОройрпНройрпИ роХрпЗроЯрпНроЯ рокро┐ройрпНрокрпБ ро╡ро╛роЯро┐роЯрпБродрпЗ", answer: "Mazhai varum ariguri" },
            { lyric: "роХрпИ ро╡рпАроЪро┐ роХро╛ро▒рпНро▒ро┐ро▓рпН, роирпА рокрпЗроЪрпБроорпН роЕро┤роХро┐ро▓рпН, роорпЖропрпНропро╛роХрпБроорпН рокрпКропрпНропрпБроорпН", answer: "Saayndhu Saayndhu" },
            { lyric: "роЙройрпН роХройрпНройроорпН роорпЗро▓рпЗ<br>рооро┤рпИ роирпАро░рпИрокрпН рокрпЛро▓рпЗ<br>роорпБродрпНродроХрпН роХрпЛро▓роорпН рокрпЛроЯ<br>роЖроЪрпИ роЕро│рпНро│ро╛роЯрпБродрпЗ<br>роирпА рокрпЗроЪрпБроорпН рокрпЗроЪрпНроЪрпБ<br>роиро╛ро│рпНродрпЛро▒рпБроорпН роХрпЗроЯрпНроЯрпБ<br>роОроирпНродройрпН роЬрпЖройрпНроороорпН родрпАро░<br>роПроХрпНроХроорпН родро│рпНро│ро╛роЯрпБродрпЗ", answer: "Oh Penne" },
            { lyric: "ропро╛ро░рпН роОроирпНродройрпН ро╡ро╛ро░рпНродрпНродрпИ роорпАродрпБ роорпМройроорпН ро╡рпИродрпНродродрпБ<br>роЗройрпНро▒рпБ рокрпЗроЪро╛рооро▓рпН роХрогрпНроХро│рпН рокрпЗроЪрпБродрпБ", answer: "Yaar Indha Saalai" },
            { lyric: "роирпЗроЪро┐роХрпНроХрпБроорпН роХро╛ро▓роорпН родро╛ройрпН ро╡рпАрогрпЖрог рокрпЛроХрпБрооро╛<br>роиро┐ройрпИро╡рпБроХро│рпН роЪрпЗроХрпНроХро┐ро▒рпЗройрпН роЗроЩрпНроХрпЗ<br>роЖропро┐ройрпБроорпН роХро╛родро▓ро┐ройрпН роХрпИроХро│ро┐ро▓рпН<br>ро╡ро┐ро░рпБроорпНрокро┐ропрпЗ ро╡ро┐ро┤рпБроХро┐ро▒рпЗройрпН роЕройрпНрокрпЗ", answer: "Un Vizhigalil" },
            { lyric: "рокрпЖрогрпНроХро│рпИ роиро┐рооро┐ро░рпНроирпНродрпБ рокро╛ро░рпНродрпНродро┐роЯ<br>роЙройрпН роЗройро┐роп роХрогрпНрогро┐ропроорпН рокро┐роЯро┐роХрпНроХрпБродрпЗ<br>роХрогрпНроХро│рпИ роирпЗро░ро╛ рокро╛родрпНродрпБ родро╛ройрпН<br>роирпА рокрпЗроЪрпБроорпН родрпЛро░рогрпИ рокро┐роЯро┐роХрпНроХрпБродрпЗ<br>родрпВро░родрпНродро┐ро▓рпН роирпА ро╡роирпНродро╛ро▓рпЗ<br>роОройрпН рооройроЪро┐ро▓рпН рооро┤рпИропроЯро┐роХрпНроХрпБроорпН рооро┐роХрокрпНрокро┐роЯро┐родрпНрод<br>рокро╛роЯро▓рпН роТройрпНро▒рпИ роЙродроЯрпБроХро│рпБроорпН роорпБрогрпБроорпБрогрпБроХрпНроХрпБроорпН", answer: "Ondra Renda" },
            { lyric: "роЗройрпНройрпБроорпН роирпВро▒рпБ роЖрогрпНроЯрпБ роироорпН роЖропрпБро│рпН ро╡рпЗрогрпБроорпН<br>роХрпИ ро░рпЗроХрпИропрпЖро▓рпНро▓ро╛роорпН родрпЗроЮрпНроЪрпБроорпН роироорпН роЖроЪрпИ ро╡ро╛ро┤рпБроорпН<br>роЙройрпН роЕройрпНрокрпБ роОройрпНройрпБроорпН рокро╛ройроорпН роОройрпН роЙроЪро┐ро░рпН ро╡ро░ ро╡рпЗрогрпБроорпН<br>роЙройрпН роорпВроЪрпНроЪрпБ роХро╛ро▒рпНро▒ро┐ро▓рпН роиро╛ройрпН роорпВро┤рпНроХро┐ рооро╛ропрпНроирпНродро┐роЯ ро╡рпЗрогрпБроорпН<br>роХрогрпНроХро│рпН роиро╛ройрпНроХрпБроорпН рокро╛ро░рпНродрпНродрпБроорпН рокро╛ро░рпНро╡рпИ роТройрпНро▒рпЗ ро╡рпЗрогрпБроорпН", answer: "Kaalathukum Nee Venum" },
            { lyric: "роТро░рпБ рокрпБро▒роорпН роиро╛рогроорпН роХро┐ро│рпНро│рпБродрпЗ<br>рооро▒рпБрокрпБро▒роорпН роЖроЪрпИ родро│рпНро│рпБродрпЗ<br>роОройрпНройрпИ роиро╛ройрпБроорпН роХрпЗроЯрпНрокрпНрокродрпБ<br>родроЯрпБрооро╛ро▒рпНро▒роорпН родро╛роХрпНроХрпБродрпБ", answer: "Oru Manam" },
            { lyric: "роКроЮрпНроЪро▓рпН рокрпЛро▓рпН родро╛ро▓ро╛роЯрпНроЯрпБроорпН<br>родрпЛро│ро┐ро▓рпН роиро╛ройрпН роЪро╛ропрпНроирпНродро╛роЯрпБроорпН роиро╛ро│ро┐ро▓рпН<br>роПройрпН ро▓рпЗроЪро╛роХ роирпА родрпЗроорпНрокро┐ройро╛ропрпН", answer: "Uyir Urugudhey" },
            { lyric: "роХро╛ро▓рпИ роОро┤рпБроирпНродродрпБроорпН роОройрпН роХрогрпНроХро│рпН роорпБродро▓ро┐ро▓рпН<br>родрпЗроЯро┐рокрпНрокро┐роЯро┐рокрпНрокродрпБроирпНродройрпН роорпБроХроорпЗ<br>родрпВроХрпНроХроорпН ро╡ро░рпБроХрпИропро┐ро▓рпН роХрогрпН рокро╛ро░рпНроХрпНроХрпБроорпН роХроЯрпИроЪро┐<br>роХро╛роЯрпНроЪро┐роХрпНроХрпБро│рпН роиро┐ро▒рпНрокродрпБроорпН роЙройрпНроорпБроХроорпЗ", answer: "Paartha Mudhal Naale" },
            { lyric: "роХрпЗроЯрпНроЯрпБ ро░роЪро┐родрпНрод рокро╛роЯро▓рпН роТройрпНро▒рпИ<br>роорпАрогрпНроЯрпБроорпН роЗройрпНро▒рпБ роЮро╛рокроХроорпН родрпВрогрпНроЯ<br>роОройрпНройрпИ роЙройрпНройрпИ роОрогрпНрогро┐родро╛ройрпЛ<br>роОро┤рпБродро┐ропродрпБ рокрпЛро▓ро╡рпЗ родрпЛройрпНро▒", answer: "Kelaamal" },
            { lyric: "роТро░рпБ роЪро┐ро▒рпБро╡ро▓ро┐ роЗро░рпБроирпНродродрпБро╡рпЗ<br>роЗродропродрпНродро┐ро▓рпЗ роЗродропродрпНродро┐ро▓рпЗ<br>роЙройродрпБ роЗро░рпБро╡ро┐ро┤ро┐ родроЯро╡ро┐ропродро╛ро▓рпН<br>роЕрооро┐ро┤рпНроирпНродрпБро╡ро┐роЯрпНроЯрпЗройрпН рооропроХрпНроХродрпНродро┐ро▓рпЗ<br>роЙродро┐ро░роЯрпНроЯрпБроорпЗ роЙроЯро▓ро┐ройрпН родро┐ро░рпИ<br>роЕродрпБродро╛ройрпЗ роЗройро┐ роиро┐ро▓ро╛ро╡ро┐ройрпН роХро░рпИ роХро░рпИ", answer: "Annul Maele" },
            { lyric: "роХро╛ро▒рпНро▒ро┐ро▓рпЗ роЖроЯрпБроорпН роХро╛роХро┐родроорпН роиро╛ройрпН<br>роирпАродро╛ройрпН роОройрпНройрпИ роХроЯро┐родроорпН роЖроХрпНроХро┐ройро╛ропрпН<br>роЕройрпНрокро┐ро▓рпН родрпКроЯроЩрпНроХро┐ роЕройрпНрокрпЛроЯрпБ роорпБроЯро┐роХрпНроХро┐ро▒рпЗройрпН<br>роОройрпН роХро▓роЩрпНроХро░рпИ ро╡ро┐ро│роХрпНроХроорпЗ", answer: "Mannipaaya" },
            { lyric: "роТро░рпБ ро╡рпАроЯрпНроЯро┐ро▓рпН роиро╛роорпН роЗро░рпБроирпНродрпБ<br>роУро░рпН роЗро▓рпИропро┐ро▓рпН роироорпН ро╡ро┐ро░рпБроирпНродрпБ<br>роЗро░рпБ родрпВроХрпНроХроорпН роТро░рпБ роХройро╡ро┐ро▓рпН<br>роорпВро┤рпНроХро┐ ро╡ро╛ро┤рпНроХрпНроХрпИ родрпКроЯроЩрпНроХрпБроорпН<br>роиро╛ройрпН роЪроорпИропро▓рпН роЪрпЖропрпНродро┐роЯрпБро╡рпЗройрпН<br>роирпА ро╡роирпНродрпБ роЕрогрпИродрпНродро┐роЯрпБро╡ро╛ропрпН<br>роОройрпН рокроЪро┐ропрпБроорпН роЙройрпН рокроЪро┐ропрпБроорпН<br>роЪрпЗро░рпНроирпНродрпЗ роТройрпНро▒ро╛ропрпН роЕроЯроЩрпНроХрпБроорпН<br>роиро╛ройрпН роХрпЗроЯрпНроЯрпБ роЖроЪрпИрокроЯрпНроЯ рокро╛роЯро▓рпН роирпВро▒рпБ<br>роирпАропрпБроорпН роиро╛ройрпБроорпН роЪрпЗро░рпНроирпНродрпЗ роХрпЗроЯрпНрокрпЛроорпН<br>родро╛ро▓ро╛роЯрпНроЯрпИ роХрогрпНрогро┐ро▓рпН роЪрпКройрпНрой роЖрогрпБроорпН роирпА родро╛ройрпН<br>роХро╛ро▓роорпН роирпЗро░роорпН родро╛рогрпНроЯро┐ ро╡ро╛ро┤рпНро╡рпЛроорпН", answer: "Maalai Mangum Neram" },
            { lyric: "роЗро░рпБрокрпНрокродрпБ роТро░рпБ рооройродрпБ<br>роЗродрпБро╡ро░рпИ роЕродрпБ роОройродрпБ<br>роОройрпНройрпИро╡ро┐роЯрпНроЯрпБ роорпЖродрпБро╡ро╛ропрпН роЕродрпБ<br>рокрпЛроХ роХрогрпНроЯрпЗройрпЗ<br>роЗродрпБ роТро░рпБ роХройро╡рпБ роиро┐ро▓рпИ<br>роХро▓рпИродрпНродро┐роЯ ро╡ро┐ро░рпБроорпНрокро╡ро┐ро▓рпНро▓рпИ<br>роХройро╡рпБроХрпНроХрпБро│рпН роХройро╡ро╛ропрпН роОройрпНройрпИ роиро╛ройрпЗ роХрогрпНроЯрпЗройрпЗ", answer: "Idhayathai Yedho Ondru" },
            { lyric: "роЙройрпН рокрпЛройрпНро▒ роЗро│рпИроЮройрпИ рооройроорпН<br>роПро▒рпНроХро╛рооро▓рпН рооро▒рпБрокрпНрокродрпЗ рокро┐ро┤рпИ<br>роХрогрпНроЯрпЗройрпН роЙройрпН роЕро▓ро╛родро┐ родрпВропрпНроорпИропрпИ<br>роОройрпН роХрогрпН рокро╛ро░рпНродрпНродрпБ рокрпЗроЪрпБроорпН рокрпЗро░ро╛рогрпНроорпИропрпИ", answer: "Visiri" },
            { lyric: "роКро░рпЖро▓рпНро▓ро╛роорпН роХрогрпНроорпВроЯро┐родрпН родрпВроЩрпНроХрпБроорпН<br>роУроЪрпИроХро│рпН роЗро▓рпНро▓ро╛род роЗро░ро╡рпЗ<br>роиро╛ройрпН роороЯрпНроЯрпБроорпН родрпВроЩрпНроХро╛рооро▓рпН<br>роПроЩрпНроХро┐ роЙройрпНрокрпЛро▓ роХро╛ропрпНроХро┐ройрпНро▒рпЗройрпН роиро┐ро▓ро╡рпЗ", answer: "Thalli Pogathey" },
            { lyric: "роОройрпН роЕроЪрпНроЪроорпН роЖроЪрпИ роОро▓рпНро▓ро╛роорпЗ<br>родро│рпНро│ро┐ рокрпЛроХроЯрпНроЯрпБроорпН<br>роОроирпНродройрпН роЗройрпНрокроорпН родрпБройрпНрокроорпН<br>роОро▓рпНро▓ро╛роорпЗ роЙройрпНройрпИ роЪрпЗро░роЯрпНроЯрпБроорпН", answer: "Neeyum Naanum" }
        ];
        const TOTAL_ROUNDS = roundsData.length;

        // --- GAME STATE ---
        let currentRound = 0;
        let score = 0;
        let roundRevealed = false;
        let highScore = localStorage.getItem('guessTheSongHighScore') || 0;

        // --- EVENT LISTENERS ---
        startBtn.addEventListener('click', startGame);
        submitBtn.addEventListener('click', handleSubmit);
        answerInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                handleSubmit();
            }
        });
        revealBtn.addEventListener('click', handleReveal);
        nextBtn.addEventListener('click', nextRound);
        playAgainBtn.addEventListener('click', () => location.reload()); // Simple reload to restart
        homeBtn.addEventListener('click', goToHome);
        gameHomeBtn.addEventListener('click', goToHome);
        shareBtn.addEventListener('click', shareScore);

        // --- GAME FLOW FUNCTIONS ---
        function startGame() {
            showScreen('game-screen');
            updateHighScoreDisplay();
            loadRound(currentRound);
        }

        function loadRound(roundIndex) {
            if (roundIndex >= TOTAL_ROUNDS) {
                endGame();
                return;
            }
            roundRevealed = false;
            const round = roundsData[roundIndex];
            lyricText.innerHTML = round.lyric;
            
            // Adjust font size for the 21st song (index 20) which is longer
            if (roundIndex === 20) {
                lyricText.style.fontSize = '1.2rem'; 
            } else {
                lyricText.style.fontSize = '1.6rem'; // Reset to default
            }

            hintArea.textContent = '';
            hintArea.classList.remove('revealed');
            answerInput.value = '';
            answerInput.disabled = false;
            
            roundCounter.textContent = `Round ${roundIndex + 1} / ${TOTAL_ROUNDS}`;
            
            // Reset button visibility
            submitBtn.style.display = 'block';
            answerInput.style.display = 'block';
            revealBtn.style.display = 'inline-block';
            nextBtn.style.display = 'none';
        }
        
        function handleSubmit() {
            const userAnswer = answerInput.value;
            if (!userAnswer.trim()) return;

            const correctAnswer = roundsData[currentRound].answer;

            if (checkAnswer(userAnswer, correctAnswer)) {
                handleCorrectAnswer();
            } else {
                handleIncorrectAnswer();
            }
        }
        
        function handleReveal() {
            roundRevealed = true;
            const correctAnswer = roundsData[currentRound].answer;
            hintArea.textContent = `Answer: ${correctAnswer}`;
            hintArea.classList.add('revealed');
            showToast('Answer revealed!', 'info');
            prepareForNextRound();
        }

        function nextRound() {
            currentRound++;
            loadRound(currentRound);
        }
        
        function endGame() {
            showScreen('end-screen');
            finalScoreDisplay.textContent = `${score} / ${TOTAL_ROUNDS}`;

            if (score > highScore) {
                highScore = score;
                localStorage.setItem('guessTheSongHighScore', highScore);
                endTitle.textContent = 'New High Score! тЬи';
            } else {
                 endTitle.textContent = 'Game Over!';
            }

            if (score === TOTAL_ROUNDS) {
                endMessage.textContent = "Perfect score! YouтАЩre the best тАФ happy BDAY WEEK!";
                triggerConfetti(200);
            } else if (score >= TOTAL_ROUNDS / 2) {
                endMessage.textContent = "Great job! You know my heart (and my playlist).";
            } else {
                endMessage.textContent = "Good try! Wanna play again and beat your score?";
            }
        }

        function goToHome() {
            // Reset game state
            currentRound = 0;
            score = 0;
            pointsCounter.textContent = `Points: ${score}`;
            
            // Go back to the welcome screen
            showScreen('welcome-screen');
        }

        // --- ANSWER VALIDATION ---
        function checkAnswer(userInput, correctSong) {
            // Normalize function to handle case, spaces, and basic punctuation
            const normalize = (str) => {
                return str
                    .toLowerCase()
                    .trim()
                    .replace(/[\.,-\/#!$%\^&\*;:{}=\-_`~()]/g, "")
                    .normalize("NFD").replace(/[\u0300-\u036f]/g, ""); // Remove diacritics
            };

            const normalizedInput = normalize(userInput);
            const normalizedAnswer = normalize(correctSong);
            
            // Exact match
            if (normalizedInput === normalizedAnswer) {
                return true;
            }

            // Partial match: check if any word from the answer is in the input
            const answerWords = normalizedAnswer.split(/\s+/).filter(word => word.length > 0);
            return answerWords.some(word => normalizedInput.includes(word));
        }

        // --- UI FEEDBACK FUNCTIONS ---
        function handleCorrectAnswer() {
            if (!roundRevealed) {
                score++;
                pointsCounter.textContent = `Points: ${score}`;
                showToast('Correct! +1', 'success');
            } else {
                showToast('Correct!', 'success');
            }
            triggerConfetti(50);
            const correctAnswer = roundsData[currentRound].answer;
            hintArea.textContent = `It was "${correctAnswer}"! You got it!`;
            hintArea.classList.remove('revealed');
            prepareForNextRound();
        }
        
        function handleIncorrectAnswer() {
            inputGroup.classList.add('shake');
            showToast('Not quite тАФ try again!', 'warning');
            setTimeout(() => inputGroup.classList.remove('shake'), 500);
        }
        
        function prepareForNextRound() {
            answerInput.disabled = true;
            submitBtn.style.display = 'none';
            revealBtn.style.display = 'none';
            nextBtn.style.display = 'inline-block';
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast show toast-${type}`;
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        function updateHighScoreDisplay() {
            if(highScore > 0) {
                 highScoreDisplay.textContent = `High Score: ${highScore}`;
            }
        }

        async function shareScore() {
            const shareText = `I scored ${score} / ${TOTAL_ROUNDS} on the "Guess the Song" BDAY WEEK game! тЭдя╕П`;
            if (navigator.share) {
                try {
                    await navigator.share({
                        title: 'Guess the Song!',
                        text: shareText,
                    });
                    showToast('Score shared!', 'info');
                } catch (err) {
                    console.error('Share failed:', err);
                    copyToClipboard(shareText);
                }
            } else {
               copyToClipboard(shareText);
            }
        }

        function copyToClipboard(text) {
             navigator.clipboard.writeText(text).then(() => {
                showToast('Score message copied to clipboard!', 'info');
            }, (err) => {
                showToast('Could not copy message.', 'warning');
            });
        }
        
        // --- DECORATIVE EFFECTS ---
        function createStars() {
            const container = document.getElementById('star-container');
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                const size = Math.random() * 3;
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.top = `${Math.random() * 100}%`;
                star.style.left = `${Math.random() * 100}%`;
                star.style.animationDelay = `${Math.random() * 5}s`;
                container.appendChild(star);
            }
        }

        function triggerConfetti(count) {
            const container = document.getElementById('confetti-container');
            const colors = ['#f72585', '#7209b7', '#3a0ca3', '#4361ee', '#4cc9f0', '#ffdde1'];
            for (let i = 0; i < count; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = `${Math.random() * 100}vw`;
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = `${Math.random() * 0.5}s`;
                if(Math.random() > 0.5) confetti.style.borderRadius = '50%';
                container.appendChild(confetti);

                setTimeout(() => {
                    confetti.remove();
                }, 3000);
            }
        }

        // --- INITIALIZATION ---
        createStars();
    </script>
</body>
</html>








